<% let data = new Date(); %>



<div class="style-tabela">
  <table id="tabela" border="0" cellpadding="0" cellspacing="0" width="100%">


    <tbody>
      <tr>
        <td class="top center"><i class="icofont-users-alt-4"><strong>ID</strong></i></td>
        <td class="top center"><strong>Nome</strong></td>
        <td class="top center"><strong>Telefone</strong></td>
        <td class="top center"><strong>Idade</strong></td>
        <td class="top center"><strong>Endere√ßo</strong></td>
        <td class="top center"><strong>Editar</strong></td>
        <td class="top center"><strong>Apagar</strong></td>
      </tr>
    </tbody>

    <tbody>

      <% verdados.forEach(verdados => { %>

      <tr class=" ">
        <td align="center"><%= verdados.id %></td>
        <td align="center"><%= verdados.nome %></td>
        <td align="center"><%= verdados.telefone %></td>

        <!--Calcula a Idade corretamente-->
        <% const hoje = new Date();%>
        <% const dataAniversario = new Date(verdados.data); %>
        <% const nascimento = new Date(dataAniversario.getFullYear(), dataAniversario.getMonth(), dataAniversario.getDate());%>
        <% let idade = hoje.getFullYear() - nascimento.getFullYear();%>
        <% const meses = hoje.getMonth() - nascimento.getMonth();%>

        <% if (meses < 0 || (meses === 0 && hoje.getDate() < nascimento.getDate())) {%>
            <% idade--;%>
        <% }%>

        <td align="center"><%= idade %>  </td>



        <td align="center"><%= verdados.endereco %> </td>

        <form action="/editacadastro/<%=verdados.id %>" method="post"></form>
        <input type="hidden" name="id" value="<%= verdados.id %>">
        <td align="center"> <a href="/editacadastro/<%=verdados.id %>"><button class="botao_edit">Verifica</button></a>
        </td>
        </form>

        <form action="/delete" method="post">
          <input type="hidden" name="id" value="<%= verdados.id %>">
          <td align="center"> <button class="botao_apag">Apaga</button> </td>
        </form>
      </tr>
      <% }); %>


    </tbody>


  </table>
</div>